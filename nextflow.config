/*
 * nextflow.config  – local Docker execution
 * Optimized for GCP VM: 64 CPUs · 412 GB RAM
 */

process {
  executor      = 'local'
  cpus          = 64
  memory        = '412 GB'
  errorStrategy = 'finish'
}

/* ---------  workflow-level parameters  --------- */
params {
  /* path to directory containing FASTA assemblies (.fasta) */
  input        = '/home/peerah/contextual'

  /* where all results are written */
  resultsDir   = '/home/peerah/contextual/results'

  /* resource knobs used inside the pipeline - optimized for your GCP VM */
  threads      = 48        // Use most of your 64 CPUs for PopPUNK processes
  ram          = '200 GB'  // Use about half your RAM for PopPUNK processes

  /* Mash settings for the pre-clustering step */
  mash_k       = 21
  mash_s       = 1000
  mash_thresh  = 0.05      // 0.05 ~ 95 % ANI
}

/* -------------  container runtime -------------- */
docker {
  enabled    = true        // run every process in its declared Docker image
  runOptions = ''          // add custom flags here if needed
}

singularity.enabled = false   // ensure Singularity isn’t used

/* -------------  reporting / visualisation ------ */
report.enabled   = true   // HTML run report
timeline.enabled = true   // Gantt chart
dag.enabled      = true   // DAG PNG

